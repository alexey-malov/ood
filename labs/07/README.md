
# **Лабораторная работа №7. Паттерн «Компоновщик»**

- [**Лабораторная работа №7. Паттерн «Компоновщик»**](#лабораторная-работа-7-паттерн-компоновщик)
  - [Критерии оценивания лабораторной работы](#критерии-оценивания-лабораторной-работы)
  - [Обязательные задания](#обязательные-задания)
    - [Задание 1 – Слайды – 100 баллов](#задание-1--слайды--100-баллов)
      - [Вопросы, которые могут помочь вам принять архитектурные решения](#вопросы-которые-могут-помочь-вам-принять-архитектурные-решения)
      - [Бонус в 50 баллов за визуализацию слайда](#бонус-в-50-баллов-за-визуализацию-слайда)
      - [Бонус в 30 баллов за юнит-тестирование класса «Группа фигур»](#бонус-в-30-баллов-за-юнит-тестирование-класса-группа-фигур)
      - [Бонус в 30 баллов за возможность клонирования фигур](#бонус-в-30-баллов-за-возможность-клонирования-фигур)

## Критерии оценивания лабораторной работы

При сдаче лабораторной работы студент должен уметь ответить на вопросы преподавателя насчёт используемых паттернов проектирования,
уметь изобразить схему паттерна на диаграмме классов, а также продемонстрировать диаграмму классов своего приложения.

- На оценку «удовлетворительно» необходимо набрать 100 баллов.
- На оценку «хорошо» необходимо набрать 150 баллов.
- На оценку «отлично» необходимо набрать 180 баллов.

**Дополнительные задания принимаются только после выполнения обязательных заданий.**

## Обязательные задания

### Задание 1 – Слайды – 100 баллов

Разработайте с использованием паттерна «Компоновщик» программу, отображающую слайды.

Слайдом считается изображение, состоящее из набора геометрических фигур. 
Фигуры могут быть примитивными (**прямоугольники**, **треугольники**, **эллипсы** и т.п.) и составными (**группы фигур**).

Каждая примитивная фигура обладает стилями обводки (`LineStyle`) и заливки (`FillStyle`),
а также ограничивающим прямоугольником (`Frame`), задающим координаты и размеры, внутри которых вписана фигура.

Стиль заливки определяется:

- Наличием заливки. Фигуры с отключенной заливкой отображаются без заполнения внутренностей
- Цветом заливки в формате RGBA

Стиль обводки определяется:

- Наличием обводки. Фигуры с отключенной обводкой отображаются без границы
- Цветом обводки в формате RGBA
- Толщиной рисования линий

Данные свойства стилей доступны как для чтения, так и для записи

Слайд, как и фигуры могут быть нарисованы на холсте, представленном интерфейсом `ICanvas`.
`ICanvas` предоставляет набор примитивных операций:

- Нарисовать отрезок прямой линии
- Нарисовать эллипс
- Заполнить эллипс
- Заполнить многоугольник, заданный массивом точек
- Изменить цвет заполнения внутренних областей фигур
- Изменить цвет рисования линий
- Изменить толщину рисования линий

Вы можете внести необходимые изменения в список данных методов.

Свойства группы должны быть следующими:

- Фреймом группы должен быть фрейм, охватывающий фреймы фигур, входящих в состав группы
  - Если какая-то из вложенных фигур изменила свой фрейм (не важно, на какой глубине),
  фрейм группы должен быть сохранять этот инвариант.
- Свойства стилей заливки и обводки группы фигур должны возвращать значение `undefined`
  (или его аналоги: `null`, `none` и т.п.), если значения свойства различается у стилей фигур внутри группы.
  - Если значение свойства стиля одинаково у всех фигур внутри группы,
  то должно возвращаться это значение.
  Например, если у всех фигур внутри группы красная обводка, то и у группы красная обводка.
  А если обводка хотя бы одной фигуры имеет другой цвет, то цвет группы должен быть `undefined`.

При модификации свойств составной фигуры, должны происходить соответствующие изменения в составляющих ее фигурах:

- При изменении фрейма группы, входящие в ее состав фигуры должны
  пропорционально изменять свои координаты и размеры (см. видео в лекции)
- При изменении любого из свойств стиля обводки, полученного у группы,
должны изменяться соответствующие свойства стилей обводки входящих в ее состав фигур.
Аналогично поведение должно быть при изменении свойств стиля заливки, полученного у группы.

В качестве реализации интерфейса `ICanvas` достаточно использовать вывод графических операций и их параметров в `stdout`.

В приложении должен создаваться слайд, на который добавлены несколько фигур, как простых, так и составных,
формирующих некоторое изображение (желательно, осмысленное). Затем приложение должно выполнять визуализацию слайда на холсте.

#### Вопросы, которые могут помочь вам принять архитектурные решения

- Какой фрейм вернёт пустая группа?
  Какой фрейм будет у группы, содержащей пустую группу и некоторую фигуру?
  Какие проблемы могут возникнуть при этом?
  Как их решить?
- Какой контейнер лучше всего подходит для хранения использоваться слайдом для хранения фигур? Обоснуйте свой выбор.
- Как при изменении стиля фигуры внутри одной из вложенных групп,
  свойства стиля корневой группы будут иметь актуальные значения?

#### Бонус в 50 баллов за визуализацию слайда

Бонус начисляется за возможность визуализации слайда с использованием произвольного графического API,
либо сохранение в виде графического файла (wmf, svg и т.п.).

При сдаче работы предоставьте файл с входными данными,
в котором команды создания фигур создают какую-то осмысленную картинку,
а не просто случайное нагромождение фигур.

#### Бонус в 30 баллов за юнит-тестирование класса «Группа фигур»

Бонус начисляется за покрытие методов Composite-классов.

#### Бонус в 30 баллов за возможность клонирования фигур

У фигуры должен быть метод `Clone`, возвращающий копию фигуры.
Если `Clone` был вызван у группы, то должна вернуться копия группы.
После клонирования группа живёт отдельной жизнью.

Подсказка - используйте паттерн проектирования прототип.
Вопрос на подумать: а как можно было бы эту возможность реализовать, не используя паттерн прототип?

Этот функционал должен быть покрыт юнит-тестами.
